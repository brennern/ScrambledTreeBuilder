# ScrambledTreeBuilder

Produce, plot and use phylogenetic trees to study genome scrambling.

## Installation

As of today there is no release. Install the development version of
*ScrambledTreeBuilder* from
[GitHub](https://github.com/brennern/ScrambledTreeBuilder/) with:

``` R
# install.packages("devtools")
remotes::install_github("brennern/ScrambledTreeBuilder", repos=BiocManager::repositories())
```

## Usage

The input of *ScrambledTreeBuilder* is YAML files produced by the
[oist/plessy_nf_GenomicBreaks](https://github.com/oist/plessy_nf_GenomicBreaks)
pipeline from all-versus-all pairwise genome alignments computed with
the (nf-core/pairgenomealign)\[<https://nf-co.re/pairgenomealign>\]
pipeline. This package includes a few YAML files in its example data,
and example objects derived from these files to compute and plot trees.
Here is an example of tree produced by *ScrambledTreeBuilder*. See the
[Get
started](https://brennern.github.io/ScrambledTreeBuilder/articles/ScrambledTreeBuilder.md)
vignette for details.

``` r
library(ScrambledTreeBuilder)
#> Loading required package: S7
visualizeTree(Halo_Tree, "Scrambling_index") +
  Halo_FocalClades +
  ggplot2::ggtitle(paste("Tree built with Percent difference and labelled with Scrambling index")) + 
  viridis::scale_color_viridis(name = "Scambling index")
```

![](reference/figures/README-SingleValueTree-1.png)

# Package index

## All functions

- [`ConvenientTblTree`](https://brennern.github.io/ScrambledTreeBuilder/reference/ConvenientTblTree.md)
  : Convenient tbl_trees

- [`FocalCladeList()`](https://brennern.github.io/ScrambledTreeBuilder/reference/FocalCladeList.md)
  : List of focal clades

- [`Haloarchaea`](https://brennern.github.io/ScrambledTreeBuilder/reference/Haloarchaea.md)
  [`Halo_DF`](https://brennern.github.io/ScrambledTreeBuilder/reference/Haloarchaea.md)
  [`Halo_PercentDiff`](https://brennern.github.io/ScrambledTreeBuilder/reference/Haloarchaea.md)
  [`Halo_FocalClades`](https://brennern.github.io/ScrambledTreeBuilder/reference/Haloarchaea.md)
  [`Halo_Tree`](https://brennern.github.io/ScrambledTreeBuilder/reference/Haloarchaea.md)
  : Example Haloarchaea data objects

- [`MRCA_2D_plot()`](https://brennern.github.io/ScrambledTreeBuilder/reference/MRCA_2D_plot.md)
  : 2D MRCA plot

- [`MRCAs()`](https://brennern.github.io/ScrambledTreeBuilder/reference/MRCAs.md)
  : Most recent common ancestors

- [`averageResults()`](https://brennern.github.io/ScrambledTreeBuilder/reference/averageResults.md)
  : Average results

- [`childSpecies()`](https://brennern.github.io/ScrambledTreeBuilder/reference/childSpecies.md)
  : Children species of an ancestor

- [`ellipsePlot()`](https://brennern.github.io/ScrambledTreeBuilder/reference/ellipsePlot.md)
  : Ellipse plots

- [`eog()`](https://brennern.github.io/ScrambledTreeBuilder/reference/eog.md)
  :

  Run `eog` on a plot for a clade

- [`extractValues()`](https://brennern.github.io/ScrambledTreeBuilder/reference/extractValues.md)
  : Extract values from a matrix.

- [`focalClade()`](https://brennern.github.io/ScrambledTreeBuilder/reference/focalClade.md)
  : Focal clades (焦点系統群)

- [`formatStats()`](https://brennern.github.io/ScrambledTreeBuilder/reference/formatStats.md)
  : Consolidate YAML reports in one data frame

- [`makeItConvenient()`](https://brennern.github.io/ScrambledTreeBuilder/reference/makeItConvenient.md)
  : Add needed columns to be convenient

- [`makeMatrix()`](https://brennern.github.io/ScrambledTreeBuilder/reference/makeMatrix.md)
  : Pairwise comparison matrix

- [`makeTidyTree()`](https://brennern.github.io/ScrambledTreeBuilder/reference/makeTidyTree.md)
  : Make a tidy tree

- [`makeValueTibble()`](https://brennern.github.io/ScrambledTreeBuilder/reference/makeValueTibble.md)
  : Project a matrix onto a tree

- [`oikData`](https://brennern.github.io/ScrambledTreeBuilder/reference/oikData.md)
  : Oikopleura data

- [`orderWithTree()`](https://brennern.github.io/ScrambledTreeBuilder/reference/orderWithTree.md)
  : Order a comparison matrix

- [`recordAncestor()`](https://brennern.github.io/ScrambledTreeBuilder/reference/recordAncestor.md)
  : Record ancestor node ID of a pair

- [`recordClades()`](https://brennern.github.io/ScrambledTreeBuilder/reference/recordClades.md)
  : Record clade metadata in results table

- [`removeAssemblies()`](https://brennern.github.io/ScrambledTreeBuilder/reference/removeAssemblies.md)
  : Remove assemblies

- [`remove_outliers()`](https://brennern.github.io/ScrambledTreeBuilder/reference/remove_outliers.md)
  : Remove outliers based on thresholds or quartiles

- [`residualBootstrapTree()`](https://brennern.github.io/ScrambledTreeBuilder/reference/residualBootstrapTree.md)
  : Residual-resampling bootstrap tree(s) from a distance matrix (UPGMA)

- [`resultFiles()`](https://brennern.github.io/ScrambledTreeBuilder/reference/resultFiles.md)
  : List YAML result files

- [`subMatrix()`](https://brennern.github.io/ScrambledTreeBuilder/reference/subMatrix.md)
  : Subset a matrix with a subtree

- [`subTree()`](https://brennern.github.io/ScrambledTreeBuilder/reference/subTree.md)
  : Extract a subtree

- [`thinByMin()`](https://brennern.github.io/ScrambledTreeBuilder/reference/thinByMin.md)
  : Thin a matrix by a minimum pairwise distance

- [`treeHeatMap()`](https://brennern.github.io/ScrambledTreeBuilder/reference/treeHeatMap.md)
  : Clustered heatmap

- [`visualizeTree()`](https://brennern.github.io/ScrambledTreeBuilder/reference/visualizeTree.md)
  : Plot a phylogenetic tree and its node data

# Articles

### All vignettes

- [ScrambledTreeBuilder](https://brennern.github.io/ScrambledTreeBuilder/articles/ScrambledTreeBuilder.md):
